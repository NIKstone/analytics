window.onerror=function(e,t,r,o,n){return setTimeout(function(){var a={};if(o=o||window.event&&window.event.errorCharacter||0,a.type="Script",a.url=window.location.href,a.line=r,a.col=o,n&&n.stack)a.msg="Script Error: ["+e+"]->["+t+","+r+":"+o+"]"+n.stack.toString()+" Last XHR Response: "+window._bugTracker_latest_xhr_response+" Last XHR RequestURL: "+window._bugTracker_latest_xhr_url;else if(arguments.callee){for(var i=[],u=arguments.callee.caller;u&&(i.push(u.toString()),u!==u.caller);)u=u.caller;i=i.join(","),a.msg="Script Error: ["+e+"]->["+t+","+r+":"+o+"]"+i+" Last XHR Response: "+window._bugTracker_latest_xhr_response+" Last XHR RequestURL: "+window._bugTracker_latest_xhr_url}a.url&&a.line&&a.col&&a.msg&&window.reportBug(a)},10),!0},document.addEventListener("error",function(e){return setTimeout(function(){var t={};t.type="Resource",t.url=window.location.href,t.line=null,t.col=null,t.msg="Resource Load Error: Tag: "+e.target.tagName+", Request URL: "+e.target.src,e.target.src.match("default-avator.png")||window.reportBug(t)},10),!0},!0),document.addEventListener("load",function(e){if(!e.path)return!0;var t=e.path[0].getAttribute("src");t=t?t:"/nourl";var r=["www.tracup.com","//www.pgyer.com","qiniu-storage.pgyer.com","static.pgyer.com","zc.pgyer.com","isite.baidu.com","www.google-analytics.com","eco-api.meiqia.com","qiniu-storage.pgyer.com",/^\/.*/,"qnssl.com","//up.qbox.me","Reference.of.Image"],o=!0;for(var n in r)if(t.match(r[n])){o=!1;break}return o&&setTimeout(function(){var t={};t.type="Resource",t.url=window.location.href,t.line=null,t.col=null,t.msg="Resource Cross Origin: Tag: "+e.path[0].tagName+", Request URL: "+e.path[0].src,"img"!=e.path[0].tagName.toLowerCase()&&window.reportBug(t)},10),!0},!0),!function(){window.XMLHttpRequest.prototype._bugTracker_openTime=0,window.XMLHttpRequest.prototype._bugTracker_sendTime=0,window.XMLHttpRequest.prototype._bugTracker_responseTime=0,window.XMLHttpRequest.prototype._bugTracker_loadTime=0,window.XMLHttpRequest.prototype._bugTracker_finishTime=0;var e=window.XMLHttpRequest;window.XMLHttpRequest=function(){var t=new e;return t._bugTracker_open=t.open,t._bugTracker_send=t.send,t.send=function(e){t._bugTracker_sendTime=(new Date).getTime(),t._bugTracker_send(e)},t.open=function(e,r,o,n,a){t.requestURL=r,t._bugTracker_openTime=(new Date).getTime(),t._bugTracker_onreadystatechange=t.onreadystatechange;var i=["//www.tracup.com","//www.pgyer.com","qiniu-storage.pgyer.com","//*.pgyer.com","//zc.pgyer.com","isite.baidu.com","www.google-analytics.com","eco-api.meiqia.com",/^\/.*/,"qnssl.com","//up.qbox.me","Reference.of.Image"],u=!0;r=r?r:"/nourl";for(var s in i)if(r.match(i[s])){u=!1;break}if(u){var c={};c.type="XHR HTTP",c.url=window.location.href,c.line=null,c.col=null,c.msg="XHR HTTP Cross Origin: targetURL: "+r}return t.onreadystatechange=function(){switch(t.readyState){case 2:t._bugTracker_responseTime=(new Date).getTime();break;case 3:t._bugTracker_loadTime=(new Date).getTime();break;case 4:t._bugTracker_finishTime=(new Date).getTime()}t._bugTracker_onreadystatechange&&t._bugTracker_onreadystatechange()},t._bugTracker_open(e,r,o,n,a)},t.addEventListener("load",function(e){var t={};return e.target.status<500||(t.type="XHR HTTP",t.url=window.location.href,t.line=null,t.col=null,t.msg="XHR HTTP Abnormal: Status: "+e.target.status+" ["+e.target.statusText+"], Request URL: "+e.target.requestURL,void(429!=e.target.status&&window.reportBug(t)))}),t.addEventListener("error",function(e){var t={};t.type="XHR ERROR",t.url=window.location.href,t.line=null,t.col=null,t.msg="XHR Error: Status: "+e.target.status+" ["+e.target.statusText+"], Request URL: "+e.target.requestURL,e.target.status&&window.reportBug(t)}),t.addEventListener("timeout",function(e){var t={};t.type="XHR TIMEOUT",t.url=window.location.href,t.line=null,t.col=null,t.msg="XHR Timeout: Status: "+e.target.status+" ["+e.target.statusText+"], Request URL: "+e.target.requestURL+", Timeout: "+e.target.timeout,window.reportBug(t)}),t}}(),window.reportBug=function(e){if(e.msg&&e.msg.match("/bugReport/frontEnd"))return!0;e.msg+=", User Agent: "+navigator.userAgent;var t=JSON.stringify(e),r=new XMLHttpRequest;r.open("POST","//localhost/report",!0),r.send(t)};